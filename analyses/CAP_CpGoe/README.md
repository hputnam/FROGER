## Analysis of CpGoe for Chromatin associated proteins 

### this analysis is based on full length genes


  
#### Scripts:
- **CAP_CpGoe.ipynb**:  jupyter notebook that 
	1. converts CpGoe file and to a sorted bed file
	2. sorts CAP.bed by chromosome order, start/stop position, and if end position is smaller than start position (reverse orientation) switches start and end positions.
	3. runs bedtools closer to find the CpGoe genes that CAP genes map closest to; reports mapping distance
	4. runs bedtools intersect to find the CpGoe genes that CAP genes map within; reports all CAP genes (even those that don't intersect any CpGoe genes)

- **CAP_CpGoe_gene_analysis.R**: R script to :
	1. remove CAP genes that don't overlap with CpGoe genes
	2. select CpGoe genes that CAP genes show the longest mapping with 
	3. plot CpGoe distributions for CAP genes across populations

#### Data Files:

- **CAP.bed**: UNSORTED bed file of chromatin associated proteins annotated by Chema's lab. Columns are chromosome, start position, end position, and protein description.
- **CAP_sorted.bed**: sorted bed file of chromatin associated proteins annotated by Chema's lab. File sorted by chromosome, start position, and end position. If end position was less than start position (gene was in reverse direction), the start and end position were swapped. Columns are chromosome, start position, end position, and protein description.
- **CpGoe.bed**: UNSORTED bed file created from ID column of ID_CpG_labelled_all file using CAP_CpGoe.ipynb script. Columns are chromosome, start position, end position, and description ("CpGoe_gene" for all lines).
- **CpGoe_sorted.bed**: sorted bed file created from ID column of ID_CpG_labelled_all file using CAP_CpGoe.ipynb script. Sorted by chromosome, start position, and end position. Columns are chromosome, start position, end position, and description ("CpGoe_gene" for all lines).
- **CAP\_CpGoe\_bed.out**: bedtools closest output from comparing CAP_sorted.bed and CpGoe_sorted.bed generated from CAP_CpGoe.ipynb script. Columns are CAP chromosome, CAP start position, CAP end position, CAP gene description, CpGoe gene chromosome, CpGoe gene start position, CpGoe gene end position, CpGoe gene description, and distance to closest CpGoe gene. Includes all genes (those that do not have any overlapping base pairs and those that overlap with more than one CpGoe gene)
- **CAP\_CpGoe\_bed\_intersect.out**: bedtools intersect output from CAP_sorted.bed and CpGoe_sorted.bed generated from CAP_CpGoe.ipynb script. Columns are CAP chromosome, CAP start position, CAP end position, CAP gene description, CpGoe gene chromosome, CpGoe gene start position, CpGoe gene end position, CpGoe gene description, and number of overlapping base pairs. Includes all genes (those that do not have any overlapping base pairs and those that overlap with more than one CpGoe gene). 
- **CAP_CpGoe_genes_by_pop_boxplot.jpg**: figure of CAP CpGoe distributions by populations generated by CAP_CpGoe_gene_analysis.R.
	
	
Chema: working on summary report/notes

Shelly: working on readme file
	
### To do next:

1. CAP gene CpGoe vs. random gene set CpGoe comparison:
	- how should we generate our random gene set(s)?
	- what statistical test should we run? (ANOVA or something)
2. Look more closely at the distributions of CpGoe for CAP genes and see if certain families (i.e. histones, HATs, HDACs, DMNTs, etc) show high or low CpGoe
	 	